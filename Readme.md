## candys-tools

基于React 实现中后台页面可视化创建。

对于通常中后端的管理平台，前端要处理的业务逻辑大概分为查询数据列表展示，详情页面展示，内容字段编辑等方面。

因此项目主要实现的就是查询页，编辑页，详情页的模板开发。比较复杂的是编辑页，一些表单元素的交互，校验。

### 模板
目前模板包括 ：*查询列表页模板 、新增页模板、编辑页模板、详情页模板* 四种模板

#### 查询页模板分为 查询条件，查询结果

#### 可配置化信息：

1. 查询对应的接口地址，请求方式，
2. 查询接口对应的查询条件字段， 字段名称，校验规则，表单元素类型（比如文字输入，时间选择，下拉选择）
3. 查询结果显示字段， 字段名称， 字段字典过滤
4. 功能操作，查询按钮后边的功能操作，页面跳转
5. 结果操作 比如详情，编辑，现在的做法是跳转到对应的页面（动态eval func 不行，this的执行问题）


#### 新增页模板分为 请求接口，字段编辑

#### 可配置化信息：

1. 新增请求接口地址，请求方式
2. 字段值，字段名称，校验规则，表单元素类型（文字输入，时间选择，下拉选择，文件上传(todo) ）
3. 字段间的联动（todo）


#### 编辑页模板分为 数据源请求，字段编辑，保存数据请求

#### 可配置化信息：

1. 编辑数据源的请求接口地址，请求方式
2. 编辑数据源的请求接口的请求参数
3. 保存数据对应的请求接口地址，请求方式
4. 需要编辑的字段信息， 字段名称，校验规则，表单元素类型（比如文字输入，时间选择，下拉选择）


#### 详情页模板分为 数据源请求，展示字段

#### 可配置化信息：

1. 数据源的请求接口地址，请求方式
2. 数据源的请求接口的请求参数
3. 需展示的字段信息，字段名称，数据字典转换
4. 功能按钮，按钮显示规则，字段名称，请求接口，请求参数，

### 数据
编辑模式 新建页面时，选择模板，对各个字段值，各种属性进行编辑做对象存储，存到数据库里

预览模式 从数据库里读取对应页面的数据对象，加载模板。

约定数据格式  请求报文，返回报文，图片上传，图片返回（todo）





### 测试环境地址

http://192.180.51.23:8090/#/projects 

测试账号 littleZuul   123456

http://192.180.51.23:8090/web/candys-tool/

-------

### v1.2 modal 功能变化 feature done
1. 新增按钮交互类型（1. 页面跳转、2.请求接口，3.modal，将目标页面呈现在modal里） done
2. 模板组件的精简，去掉重复的逻辑 done
3. 优化UI交互，新增编辑模式下侧导航的收缩 done


### v1.3 check 功能变化 feature done
1. 新增表单行内校验，支持正则 done
2. 支持选项的接口化 done
3. 支持模板的动态化, 复杂页面的模板组装, 首先要有容器模板（tab，布局模板），编排每一个容器里所支持的模板 done
4. GridLayout模板，新增布局，row col，侧边栏操作按钮 


### v1.4 formUP 功能变化 feature done
1. 表单元素 值改变，调用接口
2. 表单元素 值改变，联动其他表单是否显示，
3. 表单元素 值改变，联动其他表单值改变，
4. 表单元素 值改变，联动其他表单调用接口 
开发思路： 当一个表单value onchange的时候，通过dom调用表单的方法，根据值的规则
调用接口，将返回值，修改联动表单value，联动表单监听值变化，在调用onchange，在修改其他联动表单
一个表单输入银行卡号，另一个表单把支行显示出来
5. 表单元素 值改变，关联多个表单的改变
6. 新增表单类型 Radio，checkBox，TagRadio等。

### v1.5 fileUP 功能变化 feature done
1. 新增表单元素 文件上传   
两种显示方式：图片式、文件式
上传模式：单文件，多文件，每个文件可删除，可change， 
图片式多文件，类似于相册
文件式多文件，有文件列表
是否添加后即上传，或者有统一的上传操作按钮，
2. 修复发布流程前端缓存pageId的bug
3. 按钮样式可编辑


### v1.6 formGroup 功能变化 feature done
1. 表单联动，赋值
2. 字段分组，拖拽排序
3. 新增表单类型，提示语
4. 新增全屏FullScreen和Scroller(修改滚动条样式)组件
5. Button 配置增加按钮和提交确认交互
6. 新增，编辑模板增加按钮提交loading交互
7. 表单校验优化，隐藏表单不校验，表单下提示
8. 界面优化

### v1.7 detailUpdate 功能变化 feature
1. 新增富文本详情页模板 字段分组，表格
2. 新增selectTable，下拉table搜索，带回
3. 新增dataPicker能选择当天以后的日期
4. 动态表单取消input框，改为其他表单联动。


### v1.8 auth 功能变化 feature
1. 开发人员与运营人员权限分配，差异化显示
2. 页面层按钮权限，差异化显示
3. 增加返回字段结构

### v1.9 comminute 功能变化 feature
1. api层优化
2. 登陆获取dict字典，增加配置表单的取值方式dict取值
3. 自定义页面注入
4. 新增查找带回组件

### v2.0 comminute 功能变化 feature
1. 模板引入方式优化
2. 新增复合模板使用方式，结合react context方案， 查询条件
3. 新增自定义按钮编辑模板
4. 修改listpart模板，初始化调用接口
5. list模板调用pop弹出子模板，子模板提交后，回调list，重新查询
6. 详情页，增加字段format

### v2.1 update 功能变化
1. 查询列表操作按钮增加规则, 操作按钮规则增加 或，并，组之间的或与并 
2. listpart可编辑表格增加分页功能
3. 表单页模板，表单元素支持自定义组件
4. option动态选项获取所有数据字段
5. option接口请求参数支持从storage获取, $P.template 可以在接口请求中获取上个页面的参数
6. 二级页面调用一级页面传过来的值， context取值
7. dataPicker区间模式, dataPicker修复不选择时，会传invalid data, dataPicker新增可修改年，月组件

8. 自定义页面增加跳转配置页面的方法
9. formate 调用远程接口, 新增loadText组件
10. 新增formatePart，解决可编辑表格，字段转换问题
11. 按钮请求接口优化，可修改heder和请求参数
12. 请求参数，字段转换，隔层取值增加$p.p 如（$createTime.startDate） 
13. 增加G2图标插件
14. 详情页Uper，字段支持format， 需要配置表单样式和选择表单
15. 列表按钮调用接口，成功后刷新
16. sm2国密算法
17. 修复radio，checkBox OnChange时 表单联动
18. 修复列表页点击查询后，再重置不起作用的bug
19. 修复面包屑展示功能
20. 查找带回点击两次bug
21. 返回码根据code可做alert提示，可配置，modal框大小可调整
22. 跳转页面，弹框样式调整,宽度可配置 modal框大小可调整
23. 列表按钮调用接口，成功后刷新列表
24. 修复图片上传组件回显bug

### v2.1.1 update 功能变化

1.打包优化
2.登录页重写
3.抽离自定义按钮代码
4.format新增几种过滤方法（绝对值，字符串替换，取小数点后几位
5.时间控件优化增加可以选择时分秒的timer组件
6.时间控件增加隐藏timer功能
7.可编辑表格模板增加行内校验
8.复合模板，可以增加编辑页模板进行配置
9.修复自定义按钮调用接口没有传递tokenbug
10.修复列表组件按钮调用接口，重新刷新页面，查询条件bug
11.增加404页面，以及未登陆状态下，打开其他页面跳转到登录页逻辑
12.修复可编辑表格的多选框，数据缓存，点提交会保留上次check的数据
13.修复查找带回 输入，先点击查询，再查询 会清掉查询条件
14.查找带回checkbox至少点击一条校验
15.修复查询后，切换页面，时间控件bug

### v2.1.2 update 功能变化
1.自定义button新增action组合模式，调完接口后可执行其他action，跳转页面等
2.修复清除缓存后，页面无法跳转到登录页面bug
3.修复按钮交互后刷新列表，在获取searchdata时有问题
4.checkbox 某条数据在某种状态下disabed， 禁止做任何操作，只是展示可以看，提交时候 这条数据也不提交 todo
5.修复复合模板执行上层提交方法，配置的接口请求参数不生效
6.新增notification组件
7.修复form表单模板，调接口失败时，会清除已填表单的数据
8.修复searchCondition缓存问题:如果第一次没选择必填项，直接点查询，然后再选择必选项 再点查询  选择项清空了

### v2.1.3 update 功能变化
1. 页面管理增加菜单搜索过滤
2. 首页菜单搜索过滤
3. 修复同一文件删除后不能重复上传
4. sonar 检测，bug和异味调整
5. 修复下拉选择默认选项的bug
6. 列表查询，表头动态获取
7. copy功能，可以copy一个页面的配置，进行修改

### v2.1.4 wholeChek 功能变化
多表单校验， 表达式校验, 新建公式，因子选择，影响到的因子

wholeChek 全局校验
总金额 = 首付款 + 赊销金额 （加减乘除组合）
值因子 =  因子1 + 因子2 * 因子3

场景：
1. 因子们满足一定的规则，去控制 值因子是否显示， 调用接口， 赋值（change时触发）
2. 因子们进行值运算，去赋值给 值因子 （change时触发）
3. 因子们进行值运算，与指定因子的值的比较（大，小，等于某值）（change时触发）
4. 因子的值 与 指定因子的值的比较（大，小，等于某值）（提交时触发）
5. 当指定因子满足规则时，被动因子必填，或者满足规则（提交时触发）

交互操作：
选择主动因子（多个）
选择被动因子（多个）
校验方式 因式 or 规则

因式
  因式录入  因子1 公式 因子二 公式 因子三 a + b < c
  公式校验 第一个和最后一个类型不能为公式
  触发方式 onChange触发（提交时触发）
  交互类型 valid(校验) action toValue(赋值给被动因子， 选择赋值时 不能出现比较符号)
规则
  规则录入 主动因子规则录入 被动因子 交互类型 (是否显示， 调用接口, 初始化接口)
  触发方式 onChange触发


单表单校验新增
因子的值 与 设置的值 比较（大，小，等于某值）（提交时触发）


####全局字典缓存开发

将接口返回的数据，缓存为数据字典，下次调用该接口时，如果有配置字典则调用缓存

可以在select获取
format获取字典

全局字典， 将接口返回的数据作为字典存储，字段在进行format时可以使用字典

增加EditList配置 唯一标识keyId，可以是列表结果配置多个同一个后端字段

### v2.1.5 功能变化
新增errorBundaries组件，js运行报错时，页面不会崩溃
时间控件优化月模式和时分秒模式
可通过表单控制动态组件的行数
formatPart调用接口参数可选择其他字段
详情页模板，根据返回值控制表单展示
新增表单页表单联动会清除已填写的值bug
新增表单页表单联动会清除已上传的图片
调整storage ，解决多用户登陆问题，信息串掉的问题
新增管理页面url的拦截，非开发者用户无法进入，调整至404页面
新增react keep alive，调整listTemplat组件tablePart组件，使期支持keep Alive
### v2.2  功能变化

1. 功能的权限配置
2. 发布的优化，发布版本的审核
